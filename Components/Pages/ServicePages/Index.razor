@page "/services"
@using Microsoft.EntityFrameworkCore
@using Microsoft.AspNetCore.Components.QuickGrid
@using SpaFinalProject.Components.Models
@using SpaFinalProject.Data
@implements IAsyncDisposable
@inject IDbContextFactory<SpaFinalProject.Data.SpaFinalProjectContext> DbFactory

<PageTitle>Services</PageTitle>

<div class="container-fluid mt-5">
    <div class="card shadow-lg border-0 rounded-4 overflow-hidden w-100">

        <div class="card-header text-white py-3" style="background-color: #14452F;">
            <div class="d-flex justify-content-between align-items-center px-4">
                <h3 class="mb-0" style="font-family:'Baskerville Old Face'">Our Services</h3>
                <a href="services/create" class="btn btn-light text-success fw-bold btn-sm">
                    + Create New
                </a>
            </div>
        </div>

        <div class="card-body p-0">
            <QuickGrid Class="table table-hover table-striped mb-0 custom-table w-100" Items="context.Service">

                <PropertyColumn Property="service => service.Name" Title="Service Name" Class="fw-bold ps-4" />

                <PropertyColumn Property="service => service.Description" Title="Description" />

                <TemplateColumn Title="Duration" Class="text-center" Context="service">
                    <span class="badge bg-secondary">@service.Duration min</span>
                </TemplateColumn>

                <PropertyColumn Property="service => service.Price" Title="Price" Format="C" Class="text-end text-success fw-bold pe-4" />

                <TemplateColumn Title="Actions" Context="service" Class="text-end pe-4">
                    <a href="@($"services/edit?service_id={service.Service_Id}")" class="text-success text-decoration-none fw-bold me-2">Edit</a>
                    <a href="@($"services/details?service_id={service.Service_Id}")" class="text-secondary text-decoration-none fw-bold me-2">Details</a>
                    <a href="@($"services/delete?service_id={service.Service_Id}")" class="text-danger text-decoration-none fw-bold">Delete</a>
                </TemplateColumn>
            </QuickGrid>
        </div>
    </div>
</div>

<style>
    .custom-table tbody tr {
        transition: all 0.2s ease-in-out;
    }

        .custom-table tbody tr:hover {
            background-color: #f8f9fa;
            transform: scale(1.005);
            z-index: 5;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

    /* Updated button hover to use green text */
    .btn-light {
        border: 1px solid white;
        color: darkslategray !important; /* Forces the text to match the header */
    }

        .btn-light:hover {
            background-color: #e2e6ea;
        }

    /* Helper for the price color */
    .text-success {
        color: #198754 !important;
    }
</style>

@code {
    private SpaFinalProjectContext context = default!;

    protected override void OnInitialized()
    {
        context = DbFactory.CreateDbContext();
    }

    public async ValueTask DisposeAsync() => await context.DisposeAsync();
}